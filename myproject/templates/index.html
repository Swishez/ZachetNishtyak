<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Создать письмо</title>
<!-- Bootstrap 4 -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />

<!-- Библиотека для создания DOCX -->
<script src="https://cdn.jsdelivr.net/npm/docx@7.5.0/dist/docx.min.js"></script>
<!-- Библиотека для сохранения файла -->
<script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
</head>
<body style="background-color:#222; color:#fff;">
<div class="container">
<h1 class="mb-4 text-center" style="color:#00ffff;">Создать письмо</h1>
<form id="myForm" onsubmit="generateDoc(); return false;">
<div class="form-group">
<label for="address_text">Адресат:</label>
<textarea class="form-control" id="address_text" rows="4">К директору </textarea>
</div>
<div class="form-group">
<label for="ownline_text">ФИО:</label>
<textarea class="form-control" id="ownline_text" rows="2">Уважаемая ФИО!</textarea>
</div>
<div class="text-center">
<button type="submit" class="btn btn-primary btn-lg">Создать и скачать документ</button>
</div>
</form>
</div>

<script>
async function generateDoc() {
  const { Document, Packer, Paragraph, TextRun } = window.docx;

  const address = document.getElementById('address_text').value;
  const ownline = document.getElementById('ownline_text').value;

  const doc = new Document({
    sections: [{
      children: [
        new Paragraph({ children: [new TextRun(address)] }),
        new Paragraph({ children: [new TextRun('')] }),
        new Paragraph({ children: [new TextRun(ownline)] }),
      ],
    }],
  });

  const blob = await Packer.toBlob(doc);
  saveAs(blob, 'письмо.docx');
}
</script>

<!-- Bootstrap JS (по желанию) -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
